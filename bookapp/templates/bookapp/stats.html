{% extends 'bookapp/layout.html' %}

{% block content %}
<h3>Book stats</h3>
<ul class="mb-6 bg-white border-2 border-black rounded-lg p-6 max-w-lg mx-auto">
    <li class="mb-2 text-black font-semibold">Book with most pages: <span class="font-bold">{% if most_pages %}{{ most_pages.title }}{% else %}N/A{% endif %}</span></li>
    <li class="mb-2 text-black font-semibold">Book with least pages: <span class="font-bold">{% if least_pages %}{{ least_pages.title }}{% else %}N/A{% endif %}</span></li>
    <li class="text-black font-semibold">Average pages: <span class="font-bold">{{ avg_pages|default:"N/A" }}</span></li>
</ul>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1/dist/chart.umd.min.js"></script>

<div class="flex flex-col md:flex-row gap-8 justify-center items-center">
    <div class="bg-white border-2 border-black rounded-lg p-4">
        <canvas width="320" height="320" id="statusChart"></canvas>
    </div>
    <div class="bg-white border-2 border-black rounded-lg p-4">
        <canvas width="320" height="320" id="ratingChart"></canvas>
    </div>
</div>

<script>

    new Chart(document.getElementById('statusChart'), {
        type: 'pie',
        data: {
            labels: {{ status_labels|safe }},
            datasets: [{
                data: {{ status_values|safe }},
                label: 'Total',
                backgroundColor: [
                    '#6366f1', // indigo-500
                    '#a78bfa', // violet-400
                    '#7c3aed'  // violet-600
                ]
            }]
        },
        options: {
            responsive: false
        }
    })

    new Chart(document.getElementById('ratingChart'), {
        type: 'bar',
        data: {
            labels: {{ rating_labels|safe }},
            datasets: [{
                data: {{ rating_values|safe }},
                label: 'Total',
                backgroundColor: '#6366f1' // indigo-500
            }]
        },
        options: {
            responsive: false,
            scales: {
                x: {
                    ticks: { color: '#7c3aed', font: { weight: 'bold' } }
                },
                y: {
                    ticks: { color: '#6366f1', font: { weight: 'bold' } }
                }
            }
        }
    })
    // ...existing code for statusChart and ratingChart...
</script>
{% endblock content %}
